import{E as se}from"./base-79fc8291.js";/* empty css                */import{B as g,ai as te,P as oe,o as c,k as u,m as n,V as L,a2 as S,n as B,t as D,q as Q,T as x,H as ie,a0 as T,a1 as E,s as ne,v as re,F as ce,ae as ue,af as fe}from"./index-cc8a6564.js";import{_ as de,G as R}from"./_plugin-vue_export-helper-f68785c8.js";const ve="/assets/whiteFlag-d59ffcd1.svg",_e="/assets/arrowup-ebf7993c.svg",pe="/assets/arrowdown-e41153f5.svg",ge="/assets/deleteBtn-6cf45ede.svg",be="/assets/addBtn-8b98dae2.svg";const he=C=>(ue("data-v-4456196b"),C=C(),fe(),C),me={class:"compare-page"},we={class:"tab"},Qe={class:"tab__left"},ke=["onClick"],ye=he(()=>n("div",{class:"tab__right"},null,-1)),Le={class:"main"},Se={class:"table-container"},Be={class:"table-header"},Ce={class:"table-row"},De={style:{display:"flex","align-items":"center",gap:"9px"}},Ne={key:0,src:ve},Ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",fill:"red",version:"1.1",width:"14",height:"14",viewBox:"0 0 14 14"},Te={transform:"matrix(0,1,1,0,0,0)"},Ee=["fill-rule"],Ve={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",fill:"none",version:"1.1",width:"14",height:"14",viewBox:"0 0 14 14"},Me={transform:"matrix(0,1,-1,0,14,-14)"},Oe=["fill-rule"],$e={key:0,class:"table-cell-diffFlag"},Fe={class:"table-data"},Je={class:"table-row"},xe=["onMouseenter","onMouseleave"],Re=["onClick"],Ue={class:"arrow",src:_e},Ae={class:"arrow",src:pe},qe={key:0,class:"dropdown"},He=["onClick"],Ze=["src"],Ge=["onClick"],ze=["onMouseenter","onMouseleave"],Pe=["onClick"],je={__name:"compare",setup(C){const U=[{value:"all",label:"全部内容"},{value:"abnormal",label:"只看异常"},{value:"difference",label:"只看不同"}],V=g(0),b=g([]),A=(l,a)=>{if(V.value=l,a.value=="difference"){b.value=[...f].filter(o=>o.diff===!0);const t=b.value.map(o=>o.label);_.value=d.value.map(o=>o.filter(e=>t.includes(e.label)))}else if(a.value=="all")b.value=f,_.value=JSON.parse(JSON.stringify(d.value));else if(a.value=="abnormal"){b.value=f.filter(o=>o.serious===!0);const t=b.value.map(o=>o.label);_.value=d.value.map(o=>o.filter(e=>t.includes(e.label)))}},q=l=>{const a=h.value.find(t=>t.label==d.value[l][0].StartTime);a&&(a.choose=!1),_.value.splice(l,1)};let f=[{label:"评估时间",flag:!1,serious:!0},{label:"主诉",flag:!0},{label:"现病史",flag:!0},{label:"既往史",flag:!0},{label:"全身病史",flag:!1},{label:"手术史",flag:!1},{label:"家族史",flag:!1},{label:"外伤史",flag:!1},{label:"早期矫正史",flag:!1},{label:"过敏源",flag:!1},{label:"过敏症状",flag:!1},{label:"耳鼻喉就诊史",flag:!1},{label:"耳鼻喉用药史",flag:!1},{label:"孩子矫正意愿",flag:!0},{label:"家长矫正意愿",flag:!0},{label:"正面像",flag:!0,isImg:!0},{label:"正貌",flag:!1},{label:"唇",flag:!1},{label:"颏部偏斜",flag:!1},{label:"面上三分之一",flag:!1},{label:"面下三分之一",flag:!1},{label:"90度侧面像",flag:!0,isImg:!0},{label:"90度侧面微笑像",flag:!0,isImg:!0},{label:"面中三分之一",flag:!1}];const d=g([]),_=g([]),h=g([]),m=g([]),H=te(),M=g(),N=g(),Z=H.params.patientId;d.value=[],R(`/prod-api/business/public/api/v1/appointment/appList?patientId=${Z}`).then(l=>{if(l.code==200&&l.data.historyRecord.length>0){m.value=l.data.historyRecord,h.value=l.data.historyRecord.map(t=>({label:t.StartTime.split(" ")[0],value:t.app_id,choose:!1})),M.value=m.value[0].patientName,N.value=m.value[0].age;const a=m.value[0].app_id;O(a,0)}});const G=g(0);function z(l,a){l?a.imageUrl=l.image_url:a.imageUrl=require("../../assets/ortho/imagePlaceholderBig.png")}async function O(l,a,t){R(`/prod-api/business/orthClass/issuesList?apmtId=${l}`).then(o=>{if(o.data){const e=JSON.parse(JSON.stringify(f));if(e.forEach(s=>{const r=o.data.find(y=>y.title_name==s.label);s.value=r?r.option_names:"--",s.serious=!!(r&&r.serious=="1")}),["90度侧面像","90度侧面微笑像","正面像"].forEach(s=>{const r=o.data.find(v=>v.className==s),y=e.find(v=>v.label==s);z(r,y)}),e.forEach((s,r)=>{s.serious&&(f[r].serious=!0)}),["正貌","唇","颏部偏斜","面上三分之一","面下三分之一"].some(s=>f.find(r=>r.label==s).serious===!0)&&(f.find(s=>s.label==="正面像").serious=!0),e[0].value=`${M.value}(${N.value=="0岁"?N.value:m.value[a].age.split(" ")[1]}) | ${m.value[a].StartTime.split(" ")[0]}`,e[0].dateListVisible=!1,e[0].StartTime=m.value[a].StartTime.split(" ")[0],d.value.length==0){const s=f.map(r=>({label:r.label,value:"--",isImg:!!["90度侧面像","90度侧面微笑像","正面像"].includes(r.label)}));s.forEach(r=>{r.serious=!1,["90度侧面像","90度侧面微笑像","正面像"].includes(r.label)&&(r.imageUrl=require("../../assets/ortho/imagePlaceholderBig.png"))}),s[0].value="请选择评估报告",s[0].dateListVisible=!1,d.value.push(e),d.value.push(s),_.value=JSON.parse(JSON.stringify(d.value)),h.value[0].choose=!0}else{const s=h.value.find(v=>v.label==d.value[t][0].StartTime);s&&(s.choose=!1),d.value[t]=e,_.value=JSON.parse(JSON.stringify(d.value)),e.forEach((v,w)=>{const J=d.value[G.value];if(e[w].value!==J[w].value&&(f[w].diff=!0),["90度侧面像","90度侧面微笑像"].includes(v.label)){const le=e.find(I=>I.label==v.label),ae=J.find(I=>I.label==v.label);le.imageUrl!==ae.imageUrl&&(f[w].diff=!0)}}),["正貌","唇","颏部偏斜","面上三分之一","面下三分之一"].some(v=>f.find(w=>w.label==v).diff===!0)&&(f.find(v=>v.label==="正面像").diff=!0)}b.value=[...f]}})}const P=l=>{l.dateListVisible=!l.dateListVisible,_.value.forEach(a=>{const t=h.value.find(o=>o.label==a[0].StartTime);a[0].StartTime&&t&&(t.choose=!0)})};window.addEventListener("click",()=>{document.querySelector(".dropdown")&&_.value.forEach(a=>{a[0].dateListVisible=!1})});const j=(l,a,t)=>{l.choose||(l.choose=!0,O(h.value[a].value,a,t))},K=(l,a)=>{if(_.value.length>=3){l.showBtn=!1;return}const t=JSON.parse(JSON.stringify(f));t.forEach(o=>{o.value="--",["90度侧面像","90度侧面微笑像","正面像"].includes(o.label)&&(o.imageUrl=require("../../assets/ortho/imagePlaceholderBig.png"))}),t[0].value="请选择评估报告",t[0].dateListVisible=!1,d.value.splice(a+1,0,t),_.value.splice(a+1,0,t),l.showBtn=!1},W=l=>{l.showBtn=!0};let $;const X=(l,a)=>{$=setTimeout(()=>{a.showBtn=!1},200),Array.from(l.toElement.classList).includes("addBtn")&&clearTimeout($)};function Y(l,a){function t(o,e){const p=new Date(o[0].StartTime),i=new Date(e[0].StartTime);return a%2==0?i-p:p-i}l.sort(t)}const k=g(0),ee=()=>{k.value++,Y(_.value,k.value)};return(l,a)=>{const t=oe("Select"),o=se;return c(),u("div",me,[n("div",we,[n("div",Qe,[(c(),u(L,null,S(U,(e,p)=>n("div",{class:B(["tab__left__item",{active:V.value==p}]),key:e.value,onClick:i=>A(p,e)},D(e.label),11,ke)),64))]),ye]),n("div",Le,[n("div",Se,[n("div",Be,[n("div",Ce,[(c(!0),u(L,null,S(b.value,e=>(c(),u("div",{class:B(["table-cell",{flaged:e.flag==!0,isImg:e.isImg==!0}]),key:e.label},[n("div",De,[e.flag===!0?(c(),u("img",Ne)):Q("",!0),x(D(e.label)+" ",1),e.label==="评估时间"?(c(),u("div",{key:1,style:{display:"flex","margin-left":"20px",cursor:"pointer"},onClick:ee},[(c(),u("svg",Ie,[n("g",Te,[n("path",{d:"M12.0518,9.91667Q12.1286,9.78365,12.1684,9.63529Q12.2081,9.48693,12.2081,9.33333Q12.2081,9.17974,12.1684,9.03138Q12.1286,8.88302,12.0518,8.75L8.01036,1.75Q7.93357,1.61698,7.82496,1.50838Q7.71635,1.39977,7.58333,1.32297Q7.45032,1.24617,7.30196,1.20642Q7.15359,1.16667,7,1.16667Q6.84641,1.16667,6.69804,1.20642Q6.54968,1.24617,6.41667,1.32297Q6.28365,1.39977,6.17504,1.50838Q6.06643,1.61698,5.98964,1.75L1.94819,8.75Q1.87139,8.88302,1.83163,9.03138Q1.79188,9.17974,1.79188,9.33333Q1.79188,9.48693,1.83163,9.63529Q1.87139,9.78365,1.94819,9.91667Q2.02498,10.0497,2.13359,10.1583Q2.2422,10.2669,2.37522,10.3437Q2.50823,10.4205,2.65659,10.4602Q2.80495,10.5,2.95855,10.5L11.0415,10.5Q11.195,10.5,11.3434,10.4602Q11.4918,10.4205,11.6248,10.3437Q11.7578,10.2669,11.8664,10.1583Q11.975,10.0497,12.0518,9.91667ZM10.0311,8.75L7,3.5L3.96891,8.75L10.0311,8.75Z","fill-rule":k.value%2===1?"even":"evenodd",fill:"#fff","fill-opacity":"1"},null,8,Ee)])])),(c(),u("svg",Ve,[n("g",Me,[n("path",{d:"M26.0518,9.91667Q26.1286,9.78365,26.1684,9.63529Q26.2081,9.48693,26.2081,9.33333Q26.2081,9.17974,26.1684,9.03138Q26.1286,8.88302,26.0518,8.75L22.01036,1.75Q21.93357,1.61698,21.82496,1.50838Q21.71635,1.39977,21.58333,1.32297Q21.450319999999998,1.24617,21.30196,1.20642Q21.15359,1.16667,21,1.16667Q20.84641,1.16667,20.69804,1.20642Q20.549680000000002,1.24617,20.41667,1.32297Q20.28365,1.39977,20.17504,1.50838Q20.06643,1.61698,19.98964,1.75L15.94819,8.75Q15.87139,8.88302,15.83163,9.03138Q15.791879999999999,9.17974,15.791879999999999,9.33333Q15.791879999999999,9.48693,15.83163,9.63529Q15.87139,9.78365,15.94819,9.91667Q16.02498,10.0497,16.133589999999998,10.1583Q16.2422,10.2669,16.37522,10.3437Q16.50823,10.4205,16.65659,10.4602Q16.804949999999998,10.5,16.95855,10.5L25.0415,10.5Q25.195,10.5,25.343400000000003,10.4602Q25.491799999999998,10.4205,25.6248,10.3437Q25.7578,10.2669,25.8664,10.1583Q25.975,10.0497,26.0518,9.91667ZM24.031100000000002,8.75L21,3.5L17.96891,8.75L24.031100000000002,8.75Z","fill-rule":k.value>0&&k.value%2===0?"even":"evenodd",fill:"#FFFFFF","fill-opacity":"1"},null,8,Oe)])]))])):Q("",!0)]),!e.isImg&&e.label!=="评估时间"&&e.diff?(c(),u("span",$e,"差异")):Q("",!0)],2))),128))])]),n("div",Fe,[(c(!0),u(L,null,S(_.value,(e,p)=>(c(),u("div",{class:B(["table-data-wrapper",{singleColumn:p%2===0,toAddData:e.showBtn===!0}]),key:e.label},[(c(!0),u(L,null,S(e,(i,F)=>(c(),u("div",{class:"table-data-item",key:i.label},[n("div",Je,[n("div",{class:B(["table-cell",{time:i.label=="评估时间",isImg:i.isImg==!0}]),onMouseenter:s=>e.showDeleteBtn=!0,onMouseleave:s=>e.showDeleteBtn=!1},[i.isImg?(c(),u("img",{key:1,class:"img",src:i.imageUrl},null,8,Ze)):(c(),u("div",{key:0,class:"table-cell-text",onClick:ie(s=>P(i),["stop"])},[n("span",null,D(i.value),1),T(n("img",Ue,null,512),[[E,i.dateListVisible&&i.label=="评估时间"]]),T(n("img",Ae,null,512),[[E,!i.dateListVisible&&i.label=="评估时间"]]),i.dateListVisible&&i.label=="评估时间"?(c(),u("div",qe,[(c(!0),u(L,null,S(h.value,(s,r)=>(c(),u("div",{class:B(["option",{choose:s.choose===!0}]),key:s,onClick:y=>j(s,r,p)},[x(D(s.label)+" ",1),s.choose?(c(),ne(o,{key:0,color:"#86909C"},{default:re(()=>[ce(t)]),_:1})):Q("",!0)],10,He))),128))])):Q("",!0)],8,Re)),T(n("img",{src:ge,class:"deleteBtn",onClick:s=>q(p)},null,8,Ge),[[E,F==0&&e.showDeleteBtn]])],42,xe)])]))),128)),n("div",{class:"blankArea",onMouseenter:i=>W(e),onMouseleave:i=>X(i,e),onClick:a[0]||(a[0]=(...i)=>l.handleClick&&l.handleClick(...i))},null,40,ze),e.showBtn===!0?(c(),u("img",{key:0,class:"addBtn",src:be,onClick:i=>K(e,p)},null,8,Pe)):Q("",!0)],2))),128))])])])])}}},ll=de(je,[["__scopeId","data-v-4456196b"]]);export{ll as default};
